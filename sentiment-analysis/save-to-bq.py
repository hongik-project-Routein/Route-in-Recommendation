from google.cloud import bigquery
client = bigquery.Client()

table_id = "carbon-inkwell-290604.route_in.sentimental_score"

def save_sa(row_list):
    for row in row_list:
        userId = row[0]
        mapId = row[1]
        score = row[2]

        rows_to_insert = [
        {"userId": userId, "mapId": mapId, "score": score}
        ]

        errors = client.insert_rows_json(
            table_id, rows_to_insert
        )  # Make an API request.
        if errors == []:
            print("New rows have been added.")
        else:
            print("Encountered errors while inserting rows: {}".format(errors))

    return "Complete def save_sa"

# ## Test
# test_list = [
    
#     ['user1', '1737597646', '0.991119676872'],
#     ['user1', '26235884', '0.795439676872'],
#     ['user1', '7940799', '0.702289676870'],
#     ['user1', '11263998', '0.798989676872'],
#     ['user1', '15612278', '0.193339676879'],
#     ['user1', '10304651', '0.7981289676879'],
#     ['user1', '1228594008', '0.6982289676872'],
#     ['user1', '1933012298', '0.84129173904'],
#     ['user1', '15985522', '0.11112313212'],
#     ['user1', '447132083', '0.88231231143'],
    
#     ['user2', '1737597646', '0.333123127784'],
#     ['user2', '26235884', '0.198889676872'],
#     ['user2', '7940799', '0.543233676872'],
#     ['user2', '15612278', '0.919889676871'],
#     ['user2', '10304651', '0.11289676872'],
#     ['user2', '1228594008', '0.398843676875'],
#     ['user2', '1933012298', '0.44129173904'],

#     ['user3', '1737597646', '0.452323313230'], 
#     ['user3', '26235884', '0.333889676873'],
#     ['user3', '7940799', '0.111889676877'],
#     ['user3', '11263998', '0.884889676877'],
#     ['user3', '15612278', '0.563889676870'],
#     ['user3', '10304651', '0.912889676872'],
#     ['user3', '1228594008', '0.198889676874'],
#     ['user3', '15985522', '0.33312313212'],
#     ['user3', '447132083', '0.33231231143'],

#     ['user4', '1737597646', '0.121213144419'], 
#     ['user4', '26235884', '0.711889676871'],
#     ['user4', '7940799', '0.523643476872'],
#     ['user4', '11263998', '0.991889123473'],
#     ['user4', '15612278', '0.23488653870'],
#     ['user4', '10304651', '0.89889676870'],
#     ['user4', '1228594008', '0.348889676870'],
#     ['user4', '1737597646', '0.664634632131'], 
#     ['user4', '1933012298', '0.14129173904'],
#     ['user4', '15985522', '0.192112313212'],
#     ['user4', '447132083', '0.81231231143'],

#     ['user5', '1737597646', '0.621213144412'], 
#     ['user5', '26235884', '0.111889676872'],
#     ['user5', '7940799', '0.223889676872'],
#     ['user5', '11263998', '0.576889676231'],
#     ['user5', '15612278', '0.163889679981'],
#     ['user5', '10304651', '0.112889675777'],
#     ['user5', '1228594008', '0.218889676998'],
#     ['user5', '1737597646', '0.884634632123'], 
#     ['user5', '15985522', '0.214412313212'],

#     ['user6', '1737597646', '0.111113144413'], 
#     ['user6', '26235884', '0.212889676876'],
#     ['user6', '7940799', '0.233889676873'],
#     ['user6', '11263998', '0.9968896762123'],
#     ['user6', '15612278', '0.5438823179911'],
#     ['user6', '10304651', '0.342889675789'],
#     ['user6', '1228594008', '0.738889672228'],
#     ['user6', '1737597646', '0.434634632001'], 
#     ['user6', '447132083', '0.48231231143'],
    
#     ['user7', '1737597646', '0.223113144123'], 
#     ['user7', '26235884', '0.123889676765'],
#     ['user7', '7940799', '0.653889323811'],
#     ['user7', '11263998', '0.1368893262185'],
#     ['user7', '15612278', '0.243823173456'],
#     ['user7', '10304651', '0.662883175719'],
#     ['user7', '1228594008', '0.138449672622'],
#     ['user7', '1737597646', '0.422246320661'],
#     ['user7', '1933012298', '0.74129173904'],
#     ['user7', '15985522', '0.99122313212'],
    
#     ]
# save_sa(test_list)
